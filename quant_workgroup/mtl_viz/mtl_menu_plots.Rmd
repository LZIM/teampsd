---
title: 'MTL Menu Results: Report 1'
author: "Stacey Park"
date: "`r format(Sys.Date(), '%b %d, %Y')`"
output:
  html_document:
    df_print: paged
---

#Download R CSV file of MTL Menu results from REDCap

#Clear existing data and graphics
rm(list=ls())
graphics.off()

#Install Hmisc package
install.packages(Hmisc)

#Load Hmisc library
library(Hmisc)

``` {r, echo=F }
#Read Data from MTL Menu
mtlmenu=read.csv('ModelingToLearnMenuD_DATA_2018-11-25_0431.csv')

#Create vector of new column names using question title instead of variable descriptor
cols <- c("x",
          "y",
          "Schedule - How to manage team schedules (i.e. clinics/grids)
          to meet patients needs.",
          "New patients - How to get new patients in care, 
          while meeting existing patients needs.",
          "Return to clinic - How return to clinic orders free us to get 
          patients to the right treatment at the right time.",
          "Overwork - How overbooking or overworking 
          increases patient no shows.",
          "Psychotherapy - How to improve team psychotherapy and 
          patients patterns of engagement.",
          "Evidence-based Psychotherapy - How to improve 
          evidence-based psychotherapy in our team.",
          "Evidence-based Pharmacotherapy - How to improve 
          evidence-based pharmacotherapy in our team.",
          "Referrals - How to manage referrals to our team and 
          services (e.g., meds, therapy, group) within our team.",
          "Mix of services - How our patients engage in 
          our teams mix of services.",
          "Improvement - Which improvements will have the best effects 
          across our mix of services?",
          "Burnout - How to reduce provider burnout and 
          improve patient satisfaction with care.",
          "Staffing - How to improve team care with our existing staff mix.",
          "Suicide Prevention - How to manage high risk patients",
          "Stepped Care -  How to decide when to step patients 
          up to specialty care",
          "Stepped Care - How to decide when to step patients 
          down to primary care",
          "Care Continuum - How to manage patient care 
          across care settings, e.g., primary care, general mental health 
          and specialty mental health",
          "Measurement Based Care - How implementation of 
          measurement based care will improve patient care 
          or reduce patient risk",
          "Intake evaluations",
          "Care coordination",
          "Medication management",
          "Psychotherapy",
          "Groups",
          "Adjunctive services (i.e. art and recreation therapy, peer support specialists)",
          "Depression",
          "PTSD",
          "Alcohol use disorder",
          "Opioid use disorder")
          
#Replace column names of original data set with new column name vector 
colnames(mtlmenu) <- cols

#Create new PDF file
#pdf("mtl_menu_plots.pdf", width = 16 , height = 10, title = "MTL Menu Results")


#For loop for creating barplots of responses for questions with 5 point likert scale
for (x in 3:19){
barplot(table(factor(mtlmenu[,x], levels = -2:2)),
        main=colnames(mtlmenu)[x],
        xlab="Priority",
        ylab="Count",
        names.arg = expression("Very High", "High", "Neutral", "Low", "Very Low"),
        col="#003F72",
)
}

#For loop for creating barplots of responses for questions with 3 point likert scale
for (x in 20:29){
barplot(table(factor(mtlmenu[,x], levels = -1:1)),
        main=colnames(mtlmenu)[x],
        xlab="Priority",
        ylab="Count",
        names.arg = expression("Yes", "Neutral", "No or doesn't apply"),
        col="#003F72",
)
}
```